import { collection, doc, Timestamp, writeBatch } from 'firebase/firestore';
import type { Firestore } from 'firebase/firestore';

// Helper function to create a slug from a title
const createSlug = (title: string) => {
    return title.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]+/g, '');
};

export const articlesToSeed = [
    // 학업 관련 글 5개
    {
        authorUsername: '공부벌레',
        title: '시험 기간, 나만 힘든 거 아니지?',
        summary: '중간고사, 기말고사... 시험의 연속이다. 밤샘 공부는 기본이고, 커피와 에너지 드링크를 달고 산다. 이렇게까지 해야 하나 싶다가도, 친구들이 열심히 하는 걸 보면 나만 뒤처지는 것 같아 불안하다.',
        content: '도서관은 이미 만석이다. 다들 좀비 같은 얼굴로 책상에 앉아있다. 나도 그중 하나다. \n\n어젯밤에도 거의 새우잠을 자며 공부했는데, 머릿속에 들어오는 건 별로 없는 것 같다. 멍하니 천장을 바라보다가 다시 책으로 고개를 떨군다. "이 범위에서 시험이 나온다고? 다 외울 수 있을까?" 한숨만 나온다.\n\n가끔은 모든 걸 내려놓고 그냥 자고 싶다. 하지만 성적표에 찍힐 숫자를 생각하면 그럴 수가 없다. 좋은 대학, 좋은 미래... 어른들은 쉽게 말하지만 그 길이 너무 멀고 험난하게 느껴진다. 그래도 포기할 수는 없다. 오늘도 나는 책상 앞에 앉는다. 이 힘든 시간이 지나면 분명 좋은 날이 올 거라고, 그렇게 믿고 싶다.',
        tags: ['학업', '시험', '스트레스'],
        imageId: 'article-1',
        likeCount: 15,
    },
    {
        authorUsername: '수포자',
        title: '수학, 너란 녀석... 정복할 수 있을까?',
        summary: '개념은 알 것 같은데 문제만 풀면 막힌다. 아무리 들여다봐도 해설지의 풀이는 외계어 같다. 수학 때문에 원하는 대학에 못 갈 것 같아 두렵다. 다들 어떻게 수학 공부를 하는 걸까?',
        content: '수학 시간은 공포 영화 같다. 선생님의 설명은 자장가처럼 들리고, 칠판에 쓰인 숫자와 기호들은 나를 비웃는 것 같다. "이번에도 이해 못 했지?" 라고 말하는 듯하다.\n\n친구들은 쉽게 푸는 문제도 나에게는 거대한 벽처럼 느껴진다. 인강을 들어도, 과외를 받아도 그때뿐이다. 돌아서면 머릿속이 하얘진다. "나는 정말 수학에 재능이 없나 봐." 자책감만 늘어간다.\n\n하지만 수학을 포기하면 선택할 수 있는 학과가 확 줄어든다는 걸 안다. 그래서 오늘도 꾸역꾸역 수학 문제를 푼다. 한 문제라도 내 힘으로 풀었을 때의 그 작은 희열, 그것 하나 믿고 버텨본다. 언젠가는 수학이라는 벽을 넘을 수 있을까?',
        tags: ['학업', '수학', '고민'],
        imageId: 'article-2',
        likeCount: 22,
    },
    {
        authorUsername: '암기왕이 되고 싶어',
        title: '효율적인 암기법 좀 알려줘!',
        summary: '사회, 역사, 과학... 외워야 할 건 산더미인데, 머리는 따라주지 않는다. 깜지 쓰기는 팔만 아프고, 눈으로만 읽으니 금방 까먹는다. 나에게 맞는 암기법은 도대체 뭘까?',
        content: '밑줄 긋고, 형광펜 칠하고, 열심히 노트 정리까지 했는데... 왜 기억나는 게 없을까? 내 머릿속에 지우개가 있는 게 분명하다. 친구는 노래 가사처럼 흥얼거리며 외운다는데, 나는 왜 안 될까?\n\n백지 복습, 연상 기억법, 마인드맵... 안 해본 방법이 없다. 하지만 매번 작심삼일이다. "이 많은 걸 언제 다 외우지?" 라는 생각에 시작부터 막막하다.\n\n결국 가장 무식한 방법인 깜지를 다시 편다. 쓰다 보면 언젠간 외워지겠지 하는 막연한 기대를 품고. 하지만 정말 효과적인 방법은 없는 걸까? 나도 한번쯤 "암기 천재" 소리를 들어보고 싶다. 효율적으로 공부하고 남는 시간에 좋아하는 것도 하고 싶다. 제발 나에게 맞는 암기법을 찾고 싶다.',
        tags: ['학업', '암기', '공부법'],
        imageId: 'article-3',
        likeCount: 31,
    },
    {
        authorUsername: '밤샘러',
        title: '수면 vs 공부, 당신의 선택은?',
        summary: '시험 기간이 다가오면 늘 고민에 빠진다. 잠을 줄여서라도 더 공부해야 할까? 아니면 충분히 자고 맑은 정신으로 시험을 봐야 할까? 매번 잠의 유혹에 흔들린다.',
        content: '새벽 2시, 스탠드 불빛 아래에서 꾸벅꾸벅 졸고 있는 나를 발견한다. "조금만 더 버티자, 1시간만 더..." 라고 다짐하지만, 눈꺼풀은 천근만근이다. 침대의 포근함이 나를 유혹한다.\n\n"잠은 죽어서 자는 거야" 라고 말하는 친구도 있지만, 다음 날 시험 시간에 졸면 어떡하지? 멍한 상태로 문제를 풀면 아는 것도 틀릴 텐데. 온갖 걱정이 머릿속을 맴돈다.\n\n결국 나는 알람을 맞추고 짧은 잠을 청하기로 한다. 이게 맞는 선택인지는 모르겠다. 공부를 더 하는 게 맞았을까? 정답 없는 고민에 밤은 깊어만 간다. 시험 기간, 몸도 마음도 지쳐간다.',
        tags: ['학업', '시험', '수면'],
        imageId: 'article-4',
        likeCount: 18,
    },
    {
        authorUsername: '프로계획러',
        title: '스터디 플래너, 꼭 써야 할까?',
        summary: '친구가 예쁘게 꾸민 스터디 플래너를 보니 나도 써야 할 것 같은 압박감이 든다. 계획을 세우면 공부를 더 잘하게 될까? 하지만 계획 세우는 것 자체가 또 하나의 스트레스다.',
        content: '알록달록한 펜으로 시간대별 계획을 빼곡히 채운 친구의 플래너. 그걸 보니 내 자신이 한심하게 느껴진다. 나는 계획 없이 즉흥적으로 공부하는 편인데, 이러니 성적이 안 나오는 걸까?\n\n큰맘 먹고 플래너를 사서 계획을 세워본다. "오전 9시~11시: 수학, 11시~12시: 영어..." 하지만 계획은 계획일 뿐. 지켜지지 않는 경우가 더 많다. 밀린 계획들을 보면 자괴감만 든다. "나는 왜 이렇게 의지박약일까?"\n\n계획에 얽매이지 않고 자유롭게 공부하는 게 나에게 더 맞는 걸까? 아니면 억지로라도 계획을 세우고 지키려고 노력해야 할까? 스터디 플래너를 쓰는 게 정말 성적 향상에 도움이 되는 건지, 아니면 그냥 자기만족인 건지 혼란스럽다. 나만의 공부 스타일을 찾는 길은 멀고도 험하다.',
        tags: ['학업', '스터디플래너', '계획'],
        imageId: 'article-5',
        likeCount: 25,
    },
    // 진로 관련 글 3개
    {
        authorUsername: '꿈찾는중',
        title: '내 꿈은 뭘까? 하고 싶은 게 없어서 고민이다',
        summary: '어른들은 "꿈을 가져라" 라고 쉽게 말한다. 하지만 나는 내가 뭘 좋아하고, 뭘 잘하는지 모르겠다. 주변 친구들은 의사, 변호사, 아이돌 등 확실한 꿈이 있는데 나만 없는 것 같아 초조하다.',
        content: '진로 상담 시간은 늘 고통스럽다. "장래 희망이 뭐니?" 라는 질문에 선뜻 대답하지 못한다. 그냥 "아직 생각 중이에요" 라고 얼버무린다. 사실은 아무 생각이 없다. 뭘 하고 싶은지, 뭘 해야 할지 전혀 모르겠다.\n\n친구들은 벌써부터 관련 학과를 알아보고, 동아리 활동도 열심히 한다. 그에 비해 나는 아무런 준비도 하고 있지 않다. 이대로 시간이 흘러가다 그냥 성적에 맞춰 대학에 가고, 아무 회사에나 취직하게 될까 봐 무섭다.\n\n책도 읽어보고, 직업 탐색 프로그램에도 참여해봤지만 마음에 와닿는 게 없다. "내 가슴을 뛰게 하는 일은 과연 존재할까?" 라는 의문만 커져간다. 꿈이 없다는 건, 목적지 없이 망망대해를 떠다니는 기분이다. 나의 등대는 어디에 있을까?',
        tags: ['진로', '꿈', '고민'],
        imageId: 'article-6',
        likeCount: 42,
    },
    {
        authorUsername: '현실주의자',
        title: '좋아하는 일 vs 돈 잘 버는 일',
        summary: '나는 그림 그리는 것을 좋아하지만, 예술 계열은 돈 벌기 힘들다는 말을 너무 많이 들었다. 안정적인 직업을 선택해야 할까? 아니면 내 꿈을 좇아야 할까? 현실과 이상 사이에서 갈등한다.',
        content: '어릴 때부터 내 유일한 낙은 그림 그리기였다. 하지만 "그림 그려서 뭐 먹고 살래?" 라는 말을 들을 때마다 자신감이 사라진다. 부모님은 안정적인 공무원이나 교사가 되길 바라신다. 나도 그게 현실적인 선택이라는 걸 안다.\n\n돈 걱정 없이 내가 좋아하는 일을 하면서 살 수 있다면 얼마나 좋을까? 하지만 그건 드라마에나 나오는 이야기일지 모른다. 가난한 예술가로 살고 싶지는 않다. 그렇다고 해서 내 꿈을 완전히 포기하고 싶지도 않다.\n\n요즘은 "취미로 그림을 그리고, 직업은 다른 걸 가지면 되지 않을까?" 하는 타협안을 생각하고 있다. 하지만 그게 과연 나를 행복하게 해줄까? 돈과 꿈, 두 마리 토끼를 다 잡을 수는 없는 걸까? 인생은 선택의 연속이라는데, 너무 어려운 문제다.',
        tags: ['진로', '현실', '꿈'],
        imageId: 'article-7',
        likeCount: 55,
    },
    {
        authorUsername: '문과생',
        title: '문과라서 죄송합니다...?',
        summary: '"문과 가면 취업하기 힘들다"는 말을 귀에 못이 박히게 듣는다. 정말 문과는 답이 없는 걸까? 내가 좋아하는 역사나 문학을 공부하고 싶은데, 미래가 불안해서 선뜻 선택하기가 어렵다.',
        content: '"취업 깡패는 전화기(전자, 화학, 기계)래." 친구들의 말을 들을 때마다 위축된다. 나는 수학, 과학보다는 국어, 사회가 훨씬 재미있다. 그런데 세상은 이과생들만을 원하는 것 같다.\n\n"문송합니다(문과라서 죄송합니다)" 라는 말이 유행어처럼 번지는 세상. 내가 좋아하는 걸 공부하겠다는 게 왜 죄송한 일이 되어야 할까? 억지로 적성에 맞지도 않는 이과 과목을 공부해야 하는 걸까?\n\n분명 문과에서도 성공할 수 있는 길이 있을 텐데, 지금 당장은 너무 막막하게 느껴진다. 인공지능 시대에 문과생이 살아남는 법 같은 기사를 찾아보지만, 뾰족한 답은 보이지 않는다. 내가 좋아하는 분야를 깊이 파고들면, 나만의 길을 개척할 수 있을 거라고 믿고 싶다. 문과생도 당당하게 꿈꿀 수 있는 세상이면 좋겠다.',
        tags: ['진로', '문과', '이과', '고민'],
        imageId: 'article-1', // Re-using an image for variety
        likeCount: 38,
    },
];

export const seedArticles = async (firestore: Firestore) => {
    const articlesCollection = collection(firestore, 'articles');
    const batch = writeBatch(firestore);

    articlesToSeed.forEach((articleData, index) => {
        const docRef = doc(articlesCollection); // Auto-generate ID
        const slug = createSlug(articleData.title);
        
        // Generate a random date within the last 2 weeks
        const articleDate = new Date();
        const randomDaysAgo = Math.floor(Math.random() * 14);
        articleDate.setDate(articleDate.getDate() - randomDaysAgo);
        articleDate.setHours(Math.floor(Math.random() * 24));
        articleDate.setMinutes(Math.floor(Math.random() * 60));

        const newArticle = {
            ...articleData,
            createdAt: Timestamp.fromDate(articleDate),
            slug: `${slug}-${docRef.id.substring(0, 5)}`, // Make slug unique
        };
        batch.set(docRef, newArticle);
    });

    try {
        await batch.commit();
        console.log('Successfully seeded articles with random dates in the last two weeks.');
    } catch (error) {
        console.error('Error seeding articles:', error);
    }
};
